# 实现一个控制器

我们的CronJob控制器的基本逻辑如下：

1. 加载指定的CronJob

2. 列出所有活动的作业，并更新状态

3. 根据历史限制清理旧作业

4. 检查我们是否被暂停（如果是，则不执行其他操作）

5. 获取下一个预定运行时间

6. 如果符合预定时间、未超过截止时间，并且不受并发策略阻塞，则运行一个新作业

7. 当我们看到一个正在运行的作业（自动完成）或者到了下一个预定运行时间时，重新排队。

{{#literatego ./testdata/project/internal/controller/cronjob_controller.go}}

这是一个复杂的任务，但现在我们有一个可工作的控制器。让我们对集群进行测试，如果没有任何问题，就部署它吧！